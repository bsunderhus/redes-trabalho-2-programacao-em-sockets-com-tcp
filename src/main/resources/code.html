<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CÃ³digo do trabalho</title>
    <style>
        body {
            margin: 0;
        }
        pre {
            margin:0;
        }
    </style>
</head>
<body>
<pre style='color:#000000;background:#f1f0f0;'><span style='color:#400000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#806030; '>.</span><span style='color:#004a43; '>io</span><span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>*</span><span style='color:#806030; '>;</span>
<span style='color:#400000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#806030; '>.</span><span style='color:#004a43; '>net</span><span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>*</span><span style='color:#806030; '>;</span>
<span style='color:#400000; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#806030; '>.</span><span style='color:#004a43; '>util</span><span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>*</span><span style='color:#806030; '>;</span>

<span style='color:#400000; font-weight:bold; '>public</span> <span style='color:#400000; font-weight:bold; '>class</span> WebServer <span style='color:#806030; '>{</span>
    <span style='color:#400000; font-weight:bold; '>private</span> <span style='color:#400000; font-weight:bold; '>static</span> <span style='color:#800040; '>int</span> PORT <span style='color:#806030; '>=</span> <span style='color:#c00000; '>3000</span><span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>private</span> <span style='color:#400000; font-weight:bold; '>static</span> <span style='color:#800040; '>void</span> respondSocket<span style='color:#806030; '>(</span><span style='color:#800040; '>Socket</span> connectionSocket<span style='color:#806030; '>)</span> <span style='color:#400000; font-weight:bold; '>throws</span> <span style='color:#800040; '>IOException</span><span style='color:#806030; '>{</span>
        <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"Starting to process request..."</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>BufferedReader</span> inFromClient <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>new</span> <span style='color:#800040; '>BufferedReader</span><span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>new</span> <span style='color:#800040; '>InputStreamReader</span><span style='color:#806030; '>(</span>connectionSocket<span style='color:#806030; '>.</span>getInputStream<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>DataOutputStream</span> outToClient <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>new</span> <span style='color:#800040; '>DataOutputStream</span><span style='color:#806030; '>(</span>connectionSocket<span style='color:#806030; '>.</span>getOutputStream<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>String</span> firstLine <span style='color:#806030; '>=</span> inFromClient<span style='color:#806030; '>.</span>readLine<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>firstLine <span style='color:#806030; '>=</span><span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>null</span><span style='color:#806030; '>)</span> <span style='color:#400000; font-weight:bold; '>return</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>StringTokenizer</span> tokenizedLine <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>new</span> <span style='color:#800040; '>StringTokenizer</span><span style='color:#806030; '>(</span>firstLine<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>String</span> method <span style='color:#806030; '>=</span> tokenizedLine<span style='color:#806030; '>.</span>nextToken<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>toUpperCase<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>String</span> path <span style='color:#806030; '>=</span> tokenizedLine<span style='color:#806030; '>.</span>nextToken<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>String</span> protocol <span style='color:#806030; '>=</span> tokenizedLine<span style='color:#806030; '>.</span>nextToken<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>!</span>protocol<span style='color:#806030; '>.</span>startsWith<span style='color:#806030; '>(</span><span style='color:#e60000; '>"HTTP"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"Not an HTTP Request"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>return</span><span style='color:#806030; '>;</span>
        <span style='color:#806030; '>}</span>
        <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span>protocol <span style='color:#806030; '>+</span> <span style='color:#e60000; '>" "</span> <span style='color:#806030; '>+</span> method <span style='color:#806030; '>+</span> <span style='color:#e60000; '>" Request:"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  "</span> <span style='color:#806030; '>+</span> firstLine<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>String</span> restOfLines<span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>while</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>(</span>restOfLines <span style='color:#806030; '>=</span> inFromClient<span style='color:#806030; '>.</span>readLine<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>length<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>></span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>)</span> <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  "</span> <span style='color:#806030; '>+</span> restOfLines<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>method<span style='color:#806030; '>.</span>equals<span style='color:#806030; '>(</span><span style='color:#e60000; '>"GET"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span> writeFile<span style='color:#806030; '>(</span>path<span style='color:#806030; '>,</span> outToClient<span style='color:#806030; '>,</span> <span style='color:#400000; font-weight:bold; '>false</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>else</span> <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>method<span style='color:#806030; '>.</span>equals<span style='color:#806030; '>(</span><span style='color:#e60000; '>"HEAD"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span> writeFile<span style='color:#806030; '>(</span>path<span style='color:#806030; '>,</span> outToClient<span style='color:#806030; '>,</span> <span style='color:#400000; font-weight:bold; '>true</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>else</span> writeBadRequest<span style='color:#806030; '>(</span>outToClient<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        connectionSocket<span style='color:#806030; '>.</span>close<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    <span style='color:#806030; '>}</span>

    <span style='color:#400000; font-weight:bold; '>private</span> <span style='color:#400000; font-weight:bold; '>static</span> <span style='color:#800040; '>void</span> writeFile <span style='color:#806030; '>(</span><span style='color:#800040; '>String</span> fileName<span style='color:#806030; '>,</span> <span style='color:#800040; '>DataOutputStream</span> outToClient<span style='color:#806030; '>,</span> <span style='color:#800040; '>boolean</span> isHead<span style='color:#806030; '>)</span> <span style='color:#400000; font-weight:bold; '>throws</span> <span style='color:#800040; '>IOException</span> <span style='color:#806030; '>{</span>
        <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>fileName<span style='color:#806030; '>.</span>startsWith<span style='color:#806030; '>(</span><span style='color:#e60000; '>"/"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span> fileName <span style='color:#806030; '>=</span> fileName<span style='color:#806030; '>.</span>substring<span style='color:#806030; '>(</span><span style='color:#c00000; '>1</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>fileName<span style='color:#806030; '>.</span>length<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>=</span><span style='color:#806030; '>=</span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>)</span> fileName <span style='color:#806030; '>=</span> <span style='color:#e60000; '>"index.html"</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>isHead<span style='color:#806030; '>)</span> <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"HTTP/1.0 HEAD Response:"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>else</span> <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"HTTP/1.0 GET Response:"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>try</span> <span style='color:#806030; '>{</span>
            <span style='color:#800040; '>URL</span> url <span style='color:#806030; '>=</span> WebServer<span style='color:#806030; '>.</span>class<span style='color:#806030; '>.</span>getClassLoader<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>getResource<span style='color:#806030; '>(</span>fileName<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>String</span> filePath <span style='color:#806030; '>=</span> url<span style='color:#806030; '>.</span>getPath<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>File</span> file <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>new</span> <span style='color:#800040; '>File</span><span style='color:#806030; '>(</span>filePath<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>int</span> numOfBytes <span style='color:#806030; '>=</span> <span style='color:#806030; '>(</span><span style='color:#800040; '>int</span><span style='color:#806030; '>)</span> file<span style='color:#806030; '>.</span>length<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>byte</span><span style='color:#806030; '>[</span><span style='color:#806030; '>]</span> fileInBytes <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>new</span> <span style='color:#800040; '>byte</span><span style='color:#806030; '>[</span>numOfBytes<span style='color:#806030; '>]</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>FileInputStream</span> inFile <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>new</span> <span style='color:#800040; '>FileInputStream</span><span style='color:#806030; '>(</span>filePath<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            inFile<span style='color:#806030; '>.</span>read<span style='color:#806030; '>(</span>fileInBytes<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>String</span> output <span style='color:#806030; '>=</span> <span style='color:#e60000; '>"HTTP/1.0 200 Document Follows</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>;</span>
            outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span>output<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  "</span> <span style='color:#806030; '>+</span> output<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>fileName<span style='color:#806030; '>.</span>endsWith<span style='color:#806030; '>(</span><span style='color:#e60000; '>"jpg"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
                output <span style='color:#806030; '>=</span> <span style='color:#e60000; '>"Content-Type: image/jpeg</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>;</span>
                outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span>output<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
                <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  "</span> <span style='color:#806030; '>+</span> output<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#806030; '>}</span>
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>fileName<span style='color:#806030; '>.</span>endsWith<span style='color:#806030; '>(</span><span style='color:#e60000; '>"gif"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
                output <span style='color:#806030; '>=</span> <span style='color:#e60000; '>"Content-Type: image/gif</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>;</span>
                outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span>output<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
                <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  "</span> <span style='color:#806030; '>+</span> output<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#806030; '>}</span>
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>fileName<span style='color:#806030; '>.</span>endsWith<span style='color:#806030; '>(</span><span style='color:#e60000; '>"txt"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
                output <span style='color:#806030; '>=</span> <span style='color:#e60000; '>"Content-Type: text/plain</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>;</span>
                outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span>output<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
                <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  "</span> <span style='color:#806030; '>+</span> output<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#806030; '>}</span>
            <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  Content-length: "</span> <span style='color:#806030; '>+</span> numOfBytes <span style='color:#806030; '>+</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span><span style='color:#e60000; '>"Content-length: "</span> <span style='color:#806030; '>+</span> numOfBytes <span style='color:#806030; '>+</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  </span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span><span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>!</span>isHead<span style='color:#806030; '>)</span> outToClient<span style='color:#806030; '>.</span>write<span style='color:#806030; '>(</span>fileInBytes<span style='color:#806030; '>,</span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>,</span> numOfBytes<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#806030; '>}</span> <span style='color:#400000; font-weight:bold; '>catch</span> <span style='color:#806030; '>(</span><span style='color:#800040; '>Exception</span> e<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            <span style='color:#800040; '>String</span> output <span style='color:#806030; '>=</span> <span style='color:#e60000; '>"HTTP/1.0 404 Not Found</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>;</span>
            outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span>output<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  "</span> <span style='color:#806030; '>+</span> output<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  </span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span><span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#806030; '>}</span>
    <span style='color:#806030; '>}</span>

    <span style='color:#400000; font-weight:bold; '>private</span> <span style='color:#400000; font-weight:bold; '>static</span> <span style='color:#800040; '>void</span> writeBadRequest <span style='color:#806030; '>(</span><span style='color:#800040; '>DataOutputStream</span> outToClient<span style='color:#806030; '>)</span> <span style='color:#400000; font-weight:bold; '>throws</span>  <span style='color:#800040; '>IOException</span> <span style='color:#806030; '>{</span>
        <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"HTTP/1.0 Bad Request Response:"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  HTTP/1.0 400 Bad Request</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span><span style='color:#e60000; '>"HTTP/1.0 400 Bad Request</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  Content-length: "</span> <span style='color:#806030; '>+</span> <span style='color:#c00000; '>0</span> <span style='color:#806030; '>+</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span><span style='color:#e60000; '>"Content-length: "</span> <span style='color:#806030; '>+</span> <span style='color:#c00000; '>0</span> <span style='color:#806030; '>+</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>print<span style='color:#806030; '>(</span><span style='color:#e60000; '>"  </span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        outToClient<span style='color:#806030; '>.</span>writeBytes<span style='color:#806030; '>(</span><span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\r</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    <span style='color:#806030; '>}</span>

    <span style='color:#400000; font-weight:bold; '>public</span> <span style='color:#400000; font-weight:bold; '>static</span> <span style='color:#800040; '>void</span> main<span style='color:#806030; '>(</span><span style='color:#800040; '>String</span> args<span style='color:#806030; '>[</span><span style='color:#806030; '>]</span><span style='color:#806030; '>)</span> <span style='color:#400000; font-weight:bold; '>throws</span> <span style='color:#800040; '>IOException</span> <span style='color:#806030; '>{</span>
        <span style='color:#800040; '>ServerSocket</span> listenSocket <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>new</span> <span style='color:#800040; '>ServerSocket</span><span style='color:#806030; '>(</span>PORT<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"Web server listening to port 3000..."</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#800040; '>int</span> aux <span style='color:#806030; '>=</span> <span style='color:#c00000; '>1</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>while</span> <span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>true</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            <span style='color:#800040; '>Socket</span> socket <span style='color:#806030; '>=</span> listenSocket<span style='color:#806030; '>.</span>accept<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"Creating Thread to attend request"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>new</span> RespondThread<span style='color:#806030; '>(</span>socket<span style='color:#806030; '>,</span> aux<span style='color:#806030; '>+</span><span style='color:#806030; '>+</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>start<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#806030; '>}</span>
    <span style='color:#806030; '>}</span>
    <span style='color:#400000; font-weight:bold; '>static</span> <span style='color:#400000; font-weight:bold; '>class</span> RespondThread <span style='color:#400000; font-weight:bold; '>extends</span> <span style='color:#800040; '>Thread</span> <span style='color:#806030; '>{</span>
        <span style='color:#800040; '>Socket</span> socket<span style='color:#806030; '>;</span>
        <span style='color:#800040; '>int</span> id<span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>public</span> RespondThread<span style='color:#806030; '>(</span><span style='color:#800040; '>Socket</span> socket<span style='color:#806030; '>,</span> <span style='color:#800040; '>int</span> id<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"Thread "</span> <span style='color:#806030; '>+</span> id <span style='color:#806030; '>+</span> <span style='color:#e60000; '>" created successfully"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>.</span>socket <span style='color:#806030; '>=</span> socket<span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>.</span>id <span style='color:#806030; '>=</span> id<span style='color:#806030; '>;</span>
        <span style='color:#806030; '>}</span>
        <span style='color:#400000; font-weight:bold; '>public</span> <span style='color:#800040; '>void</span> run<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"Starting Thread "</span> <span style='color:#806030; '>+</span> id<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>try</span> <span style='color:#806030; '>{</span>
                WebServer<span style='color:#806030; '>.</span>respondSocket<span style='color:#806030; '>(</span>socket<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#806030; '>}</span> <span style='color:#400000; font-weight:bold; '>catch</span> <span style='color:#806030; '>(</span><span style='color:#800040; '>Exception</span> e<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
                e<span style='color:#806030; '>.</span>printStackTrace<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            <span style='color:#806030; '>}</span>
            <span style='color:#800040; '>System</span><span style='color:#806030; '>.</span>out<span style='color:#806030; '>.</span>println<span style='color:#806030; '>(</span><span style='color:#e60000; '>"Stopping Thread "</span> <span style='color:#806030; '>+</span> id<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#806030; '>}</span>
    <span style='color:#806030; '>}</span>
<span style='color:#806030; '>}</span>
</pre>
</body>
</html>